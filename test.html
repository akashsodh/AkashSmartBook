<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>मॉक टेस्ट</title>
  <link rel="manifest" href="manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css"> 
</head>
<body>

  <div class="quiz-container">
    <h1>मॉक टेस्ट</h1>
    <div id="quiz-content">
        </div>
    <div class="navigation" style="margin-top: 20px;">
      <button onclick="prevQuestion()">पिछला</button>
      <button onclick="nextQuestion()">अगला</button>
    </div>
    <div id="explanation-box" style="margin-top: 15px;"></div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="script.js"></script>

  <script>
    let questions = [];
    let currentQuestionIndex = 0;
    const answers = {}; // उत्तरों को स्टोर करने के लिए

    // DOM लोड होने के बाद क्विज़ शुरू करें
    document.addEventListener('DOMContentLoaded', () => {
        loadAndDisplayQuestions();
    });

    // प्रश्न लोड और डिस्प्ले करने का फंक्शन
    async function loadAndDisplayQuestions() {
        try {
            const response = await fetch('questions.json');
            if (!response.ok) {
                throw new Error('questions.json फाइल नहीं मिली!');
            }
            questions = await response.json();
            
            if (questions.length > 0) {
                displayQuestion();
            } else {
                document.getElementById('quiz-content').innerHTML = 'कोई प्रश्न नहीं मिला।';
            }
        } catch (error) {
            console.error('प्रश्न लोड करने में त्रुटि:', error);
            document.getElementById('quiz-content').innerHTML = `<p style="color:red;">त्रुटि: ${error.message}</p>`;
        }
    }

    // स्क्रीन पर प्रश्न दिखाने का फंक्शन
    function displayQuestion() {
        if (currentQuestionIndex >= questions.length) return;

        const q = questions[currentQuestionIndex];
        const quizContent = document.getElementById('quiz-content');
        const explanationBox = document.getElementById('explanation-box');
        
        let html = `<div class="question">Q${currentQuestionIndex + 1}: ${q.question}</div>`;
        
        q.options.forEach((option, index) => {
            html += `<label id="opt-${index}"><input type="radio" name="question${currentQuestionIndex}" value="${index}" onclick="selectAnswer(${index})"> ${option}</label>`;
        });

        quizContent.innerHTML = html;
        explanationBox.innerHTML = ''; // स्पष्टीकरण को साफ़ करें

        // अगर इस प्रश्न का उत्तर पहले ही दिया जा चुका है, तो उसे दिखाएं
        if (answers[currentQuestionIndex] !== undefined) {
            const selectedOption = answers[currentQuestionIndex];
            document.querySelector(`input[value="${selectedOption}"]`).checked = true;
            checkAnswer(selectedOption, false); // सिर्फ UI अपडेट करें, दोबारा उत्तर न जांचें
        }
    }

    // उत्तर चुनने पर चलने वाला फंक्शन
    function selectAnswer(selectedIndex) {
        if (answers[currentQuestionIndex] !== undefined) return; // अगर उत्तर दिया जा चुका है तो कुछ न करें
        
        answers[currentQuestionIndex] = selectedIndex;
        checkAnswer(selectedIndex, true);
    }
    
    // उत्तर जांचने और UI अपडेट करने का फंक्शन
    function checkAnswer(selectedIndex, isNewAnswer) {
        const q = questions[currentQuestionIndex];
        const correctAnswerIndex = q.answer;

        // सभी विकल्पों को लॉक कर दें
        document.querySelectorAll(`input[name="question${currentQuestionIndex}"]`).forEach(input => {
            input.disabled = true;
        });

        // सही और गलत विकल्प को हाइलाइट करें
        if (selectedIndex === correctAnswerIndex) {
            document.getElementById(`opt-${selectedIndex}`).classList.add('correct');
        } else {
            document.getElementById(`opt-${selectedIndex}`).classList.add('incorrect');
            document.getElementById(`opt-${correctAnswerIndex}`).classList.add('correct');
        }

        // स्पष्टीकरण दिखाएं
        if (q.explanation) {
            document.getElementById('explanation-box').innerHTML = `<div class="explanation"><strong>व्याख्या:</strong> ${q.explanation}</div>`;
        }
    }

    // अगला प्रश्न
    function nextQuestion() {
        if (currentQuestionIndex < questions.length - 1) {
            currentQuestionIndex++;
            displayQuestion();
        } else {
            alert("टेस्ट समाप्त!");
        }
    }

    // पिछला प्रश्न
    function prevQuestion() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            displayQuestion();
        }
    }
  </script>

</body>
</html>
